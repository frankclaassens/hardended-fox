//

//******************************************************************************
//* MY CUSTOM PREFS                                                            *
//******************************************************************************
lockPref("media.gmp-widevinecdm.enabled", false);
lockPref("signon.management.page.breach-alerts.enabled", false);
lockPref("places.history.enabled", true);
lockPref("accessibility.force_disabled", 1);
lockPref("app.update.auto", false);
lockPref("general.smoothScroll", false);
lockPref("layout.spellcheckDefault", 0);
lockPref("security.family_safety.mode", 0);
lockPref("dom.forms.autocomplete.formautofill", false);
lockPref("dom.w3c_touch_events.enabled", 0);

lockPref("extensions.update.autoUpdateDefault", false);
lockPref("extensions.htmlaboutaddons.discover.enabled", false);
lockPref("extensions.htmlaboutaddons.inline-options.enabled", false);
lockPref("extensions.activeThemeID", "librefox-dark-theme@intika.be");
lockPref("extensions.ui.dictionary.hidden", true);
lockPref("extensions.ui.locale.hidden", true);
lockPref("extensions.systemAddon.update.enabled", false);
lockPref("extensions.systemAddon.update.url", "");
lockPref("extensions.webcompat-reporter.enabled", false);
lockPref("extensions.screenshots.disabled", true);
lockPref("extensions.screenshots.upload-disabled", true);
lockPref("extensions.formautofill.addresses.enabled", false);
lockPref("extensions.formautofill.available", "off");
lockPref("extensions.formautofill.creditCards.enabled", false);
lockPref("extensions.formautofill.heuristics.enabled", false);

//lockPref("extensions.webcompat.perform_injections", true);
//lockPref("extensions.webcompat.perform_ua_overrides", true);

lockPref("media.autoplay.default", 5);
lockPref("media.eme.enabled", false);
lockPref("media.videocontrols.picture-in-picture.video-toggle.enabled", false);
lockPref("media.gmp-gmpopenh264.autoupdate", false);
lockPref("media.gmp-gmpopenh264.enabled", false);
lockPref("media.video_stats.enabled", false);

//lockPref("network.proxy.type", 0);

lockPref("privacy.clearOnShutdown.downloads", true);
lockPref("privacy.clearOnShutdown.history", false);
lockPref("privacy.clearOnShutdown.offlineApps", true);
lockPref("privacy.clearOnShutdown.siteSettings", true);
lockPref("privacy.clearOnShutdown.formdata", true);
lockPref("privacy.clearOnShutdown.sessions", false);

// Tracking Protection
lockPref("privacy.donottrackheader.enabled", true);
lockPref("privacy.trackingprotection.cryptomining.enabled", false);
lockPref("privacy.trackingprotection.fingerprinting.enabled", false);
lockPref("privacy.trackingprotection.enabled", false);
lockPref("privacy.trackingprotection.pbmode.enabled", false);

// Device permission prefs
lockPref("permissions.default.camera", 2);
lockPref("permissions.default.desktop-notification", 2);
lockPref("permissions.default.geo", 2);
lockPref("permissions.default.microphone", 2);

lockPref("pref.downloads.disable_button.edit_actions", false);
lockPref("pref.privacy.disable_button.view_passwords", false);
lockPref("pref.privacy.disable_button.tracking_protection_exceptions", false);
lockPref("pref.privacy.disable_button.cookie_exceptions", false);

lockPref("browser.download.useDownloadDir", false);
lockPref("browser.search.useDBForOrder", true);
lockPref("browser.preferences.defaultPerformanceSettings.enabled", false);

// Google Safe-Browsing
lockPref("browser.safebrowsing.malware.enabled", false);
lockPref("browser.safebrowsing.phishing.enabled", false);
lockPref("browser.safebrowsing.downloads.enabled", false);
lockPref("browser.safebrowsing.downloads.remote.block_potentially_unwanted", false);
lockPref("browser.safebrowsing.downloads.remote.block_uncommon", false);

lockPref("browser.safebrowsing.downloads.remote.enabled", false);
lockPref("browser.safebrowsing.downloads.remote.url", "");
lockPref("browser.safebrowsing.allowOverride", false);

lockPref("browser.startup.page", 3);
lockPref("browser.tabs.insertAfterCurrent", true);

lockPref("browser.newtabpage.activity-stream.asrouter.userprefs.cfr.addons", false);
lockPref("browser.newtabpage.activity-stream.asrouter.userprefs.cfr.features", false);
lockPref("browser.newtabpage.activity-stream.feeds.snippets", false);
lockPref("browser.newtabpage.activity-stream.section.highlights.includeDownloads", false);
lockPref("browser.newtabpage.activity-stream.section.highlights.includePocket", false);
lockPref("browser.newtabpage.activity-stream.section.highlights.rows", 2);
lockPref("browser.newtabpage.activity-stream.topSitesRows", 2);

lockPref("browser.uidensity", 1);
lockPref("app.shield.optoutstudies.enabled", false);
lockPref("datareporting.healthreport.uploadEnabled", false);
lockPref("trailhead.firstrun.didSeeAboutWelcome", true);

lockPref("app.normandy.first_run", false);
lockPref("app.normandy.enabled", false);
lockPref("app.normandy.api_url", "");
lockPref("signon.rememberSignons", false);

// Mixed Content
lockPref("security.mixed_content.block_active_content", true);
lockPref("security.mixed_content.block_object_subrequest", true);
lockPref("security.mixed_content.block_display_content", true);
lockPref("security.mixed_content.upgrade_display_content", true);

// OSCP Stapling
lockPref("security.ssl.enable_ocsp_stapling", false);
lockPref("security.ssl.enable_ocsp_must_staple", false);
lockPref("security.OCSP.require", false);
lockPref("security.OCSP.enabled", 0);

// Use only TLS 1.1, 1.2 and 1.3
lockPref("security.tls.version.min", 3);
lockPref("security.tls.version.max", 4);
lockPref("security.tls.version.fallback-limit", 3);

// Disable session identifier
lockPref("security.ssl.disable_session_identifiers", true)
lockPref("security.ssl.enable_false_start", false)
lockPref("security.tls.enable_0rtt_data", false);
lockPref("security.tls.version.enable-deprecated", false);

// Disable weak cipher
lockPref("security.ssl3.rsa_aes_128_sha", false);
lockPref("security.ssl3.rsa_aes_256_sha", false);
lockPref("security.ssl3.rsa_des_ede3_sha", false);
lockPref("security.ssl3.dhe_rsa_aes_128_sha", false);
lockPref("security.ssl3.dhe_rsa_aes_256_sha", false);
lockPref("security.ssl3.ecdhe_rsa_aes_128_sha", false);
lockPref("security.ssl3.ecdhe_ecdsa_aes_128_sha", false);
lockPref("security.ssl3.ecdhe_ecdsa_aes_256_sha", false);

// Enable strong cipher
lockPref("security.ssl3.ecdhe_rsa_aes_256_sha", true);  //grc.com
lockPref("security.ssl3.ecdhe_ecdsa_aes_256_gcm_sha384", true);
lockPref("security.ssl3.ecdhe_ecdsa_chacha20_poly1305_sha256", true);
lockPref("security.ssl3.ecdhe_rsa_aes_256_gcm_sha384", true);
lockPref("security.ssl3.ecdhe_rsa_chacha20_poly1305_sha256 ", true);

// Disable SHA1 Certs
lockPref("security.pki.sha1_enforcement_level", 1);

// Disable intermediate cert caching
lockPref("security.nocertdb", true);

// Enforce strict cert pinning
lockPref("security.cert_pinning.enforcement_level", 2);

// Disable SSL Error Reporting
lockPref("security.ssl.errorReporting.automatic", false);
lockPref("security.ssl.errorReporting.enabled", false);
lockPref("security.ssl.errorReporting.url", "");

// Prevent websites from disabling new window features
lockPref("dom.disable_window_open_feature.close", true);
lockPref("dom.disable_window_open_feature.location", true);
lockPref("dom.disable_window_open_feature.menubar", true);
lockPref("dom.disable_window_open_feature.minimizable", true);
lockPref("dom.disable_window_open_feature.personalbar", true);
lockPref("dom.disable_window_open_feature.resizable", true);
lockPref("dom.disable_window_open_feature.status", true);
lockPref("dom.disable_window_open_feature.titlebar", true);
lockPref("dom.disable_window_open_feature.toolbar", true);
lockPref("dom.disable_window_move_resize", true);

// Block extern protocols
lockPref("network.protocol-handler.external.mailto", false);
lockPref("network.protocol-handler.external.news", false);
lockPref("network.protocol-handler.external.nntp", false);
lockPref("network.protocol-handler.external.snews", false);

// Disable asmjs
lockPref("javascript.options.asmjs", false);
lockPref("javascript.options.wasm", false);

// disable idle (mous+keyboard) observation
lockPref("dom.idle-observers-api.enabled", false);

// block supercookie
lockPref("dom.sms.requestStatusReport", false);
lockPref("dom.server-events.enabled", false);

// disable vulnerable font 
lockPref("gfx.font_rendering.graphite.enabled", false);

// Disable Telemetry
lockPref("security.identitypopup.recordEventElemetry", false);
lockPref("security.certerrors.recordEventTelemetry", false);
lockPref("permissions.eventTelemetry.enabled", false);
lockPref("browser.ping-centre.telemetry", false);
lockPref("browser.urlbar.trimURLs", false);  
lockPref("browser.newtabpage.activity-stream.feeds.telemetry", false);
lockPref("browser.newtabpage.activity-stream.telemetry", false);
lockPref("browser.newtabpage.activity-stream.telemetry.ping.endpoint", "");
lockPref("browser.newtabpage.activity-stream.telemetry.structuredIngestion.endpoint", "");
lockPref("browser.pingcentre.telemetry", false);
lockPref("devtools.onboarding.telemetry-logged", false);
lockPref("devtools.onboarding.telemetry.logged", false);
lockPref("media.wmf.deblacklisting-for-telemetry-in-gpu-process", false);
lockPref("toolkit.telemetry.updatePing.enabled", false);
lockPref("toolkit.telemetry.shutdownPingSender.enabled", false);
lockPref("toolkit.telemetry.server", "");
lockPref("toolkit.telemetry.archive.enabled", false);
lockPref("toolkit.telemetry.bhrping.enabled", false);
lockPref("toolkit.telemetry.firstshutdownping.enabled", false);
lockPref("toolkit.telemetry.hybridcontent.enabled", false);
lockPref("toolkit.telemetry.newprofileping.enabled", false);
lockPref("toolkit.telemetry.unified", false);
lockPref("toolkit.telemetry.updateping.enabled", false);
lockPref("toolkit.telemetry.shutdownpingsender.enabled", false);
lockPref("toolkit.telemetry.reportingpolicy.firstRun", false);
lockPref("toolkit.telemetry.cachedClientID", "");

// Disable Plugin Scanning
lockPref("plugin.scan.plid.all", false);

// Disable all disk caching PERIOD
lockPref("browser.cache.disk.enable", false);
lockPref("browser.cache.disk_cache_ssl", false);
lockPref("browser.cache.memory.enable", false);
lockPref("browser.cache.offline.enable", false);
lockPref("browser.cache.insecure.enable", false);

// Disable formfill
lockPref("browser.formfill.enable", false);

// Disable the HORRIBLE webRTC
lockPref("media.gmp-manager.url", "<>");
lockPref("media.peerconnection.identity.timeout", 1);
lockPref("media.peerconnection.turn.disable", false);
lockPref("media.peerconnection.video.enabled", false);
lockPref("media.peerconnection.enabled", false);
lockPref("media.peerconnection.ice.no_host", true);

// Disable Referrer Headers (WHY is this is a thing)
lockPref("network.http.sendRefererHeader", 0);

// Disable direct GPU access (WEBGL)
lockPref("webgl.disabled", true);
lockPref("webgl.disable-extensions", true);
lockPref("webgl.disable-fail-if-major-performance-caveat", true);
lockPref("webgl.min_capability_mode", true);
lockPref("webgl.enable-debug-renderer-info", false);
lockPref("pdfjs.enableWebGL", false);

// Disable battery life check
lockPref("dom.battery.enabled", false);

// Make requests only to site being visited
lockPref("privacy.firstparty.isolate", true)
lockPref("privacy.firstparty.isolate.restrict_opener_access", true);

// Disable new tab privacy concerns
lockPref("accessibility.force_disabled", 1);
lockPref("browser.newtabpage.activity-stream.asrouter.userprefs.cfr.addons", false);
lockPref("browser.newtabpage.activity-stream.asrouter.userprefs.cfr.features", false);
lockPref("browser.newtabpage.activity-stream.feeds.section.highlights", false);
lockPref("browser.newtabpage.activity-stream.feeds.section.topstories", false);
lockPref("browser.newtabpage.activity-stream.feeds.section.topstories.rec.impressions", "{\"50465\":1576448311544,\"50504\":1576448311544,\"50513\":1576448311544}");
lockPref("browser.newtabpage.activity-stream.feeds.section.topstories.spoc.impressions", "{\"2323\":[1576448311615,1576448311641,1576448317243]}");
lockPref("browser.newtabpage.activity-stream.feeds.snippets", false);
lockPref("browser.newtabpage.activity-stream.feeds.topsites", false);
lockPref("browser.newtabpage.activity-stream.impressionId", "{bc349b2a-4696-4afa-bf4f-48d1fd919fe0}");
lockPref("browser.newtabpage.activity-stream.improvesearch.topSiteSearchShortcuts.havePinned", "google,amazon");
lockPref("browser.newtabpage.activity-stream.prerender", false);
lockPref("browser.newtabpage.activity-stream.section.highlights.includeBookmarks", false);
lockPref("browser.newtabpage.activity-stream.section.highlights.includeDownloads", false);
lockPref("browser.newtabpage.activity-stream.section.highlights.includePocket", false);
lockPref("browser.newtabpage.activity-stream.section.highlights.includeVisited", false);
lockPref("browser.newtabpage.activity-stream.showSearch", false);
lockPref("browser.newtabpage.activity-stream.showSponsored", false);
lockPref("browser.newtabpage.enabled", false);
lockPref("browser.newtabpage.storageVersion", 1);

// Disable spell check and enable clear on shutdown
lockPref("layout.spellcheckDefault", 0);

// Always block All third-party cookies
lockPref("browser.contentblocking.category", "custom");
lockPref("network.cookie.cookieBehavior",1);
lockPref("network.cookie.lifetimePolicy", 2);

lockPref("network.http.speculative-parallel-limit", 0);

lockPref("pdfjs.enabledCache.state", true);
lockPref("pdfjs.migrationVersion", 2);

// Correct Permissions
lockPref("permissions.default.camera", 2);
lockPref("permissions.default.desktop-notification", 2);
lockPref("permissions.default.geo", 2);
lockPref("permissions.default.microphone", 2);

// Enable privacy sanitization and disable PDF full page
lockPref("plugin.disable_full_page_plugin_for_types", "application/pdf");
lockPref("pref.privacy.disable_button.cookie_exceptions", false);

lockPref("trailhead.firstrun.didSeeAboutWelcome", true);

// Enable WebRender
lockPref("gfx.webrender.enabled",true);
lockPref("gfx.webrender.all", true);

// DNS
lockPref("network.trr.resolvers", "");
lockPref("network.trr.uri", "");
lockPref("network.trr.mode", 5);
lockPref("network.dns.disablePrefetch", true);
lockPref("network.dns.disablePrefetchFromHTTPS", true);
lockPref("network.dnsCacheEntries", 100);
lockPref("network.dnsCacheExpiration", 30);
lockPref("network.dnsCacheExpirationGracePeriod", 30);
lockPref("network.dns.disableIPv6", true);
lockPref("network.proxy.proxy_over_tls", false);
lockPref("network.connectivity-service.DNSv4.domain", "");
lockPref("network.connectivity-service.DNSv6.domain", "");
lockPref("network.predictor.enabled", false);
lockPref("network.predictor.enable-prefetch", false);

lockPref("network.prefetch-next", false);
lockPref("network.http.speculative-parallel-limit", 0);

// Show insecure lock icon when http
lockPref("network.ftp.enabled ", false);
lockPref("security.insecure_connection_icon.enabled", true);
lockPref("security.insecure_connection_icon.pbmode.enabled", true);

// TLS Renegotiation
lockPref("security.ssl.treat_unsafe_negotiation_as_broken", true);
lockPref("security.ssl.require_safe_negotiation", true);

// Disable WebRTC getUserMedia, screen sharing, audio capture, video capture
lockPref("media.navigator.enabled", false);
lockPref("media.navigator.video.enabled", false);
lockPref("media.getusermedia.screensharing.enabled", false);
lockPref("media.getusermedia.audiocapture.enabled", false);

// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );

//******************************************************************************
// Heimdallr -- Added -- Privacy Enhanced
//******************************************************************************

// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );
// lockPref("", );


// PREF: Disable Service Workers
lockPref("dom.serviceWorkers.enabled", false);

// PREF: Disable web notifications
lockPref("dom.webnotifications.enabled", false);

// PREF: Disable DOM timing API
lockPref("dom.enable_performance", false);

// PREF: Make sure the User Timing API does not provide a new high resolution timestamp
lockPref("dom.enable_user_timing", false);

// PREF: Disable Web Audio API
lockPref("dom.webaudio.enabled", false);

// PREF: Disable Location-Aware Browsing (geolocation)
lockPref("geo.enabled", false);

// PREF: When geolocation is enabled, use Mozilla geolocation service instead of Google
lockPref("geo.wifi.uri", "https://location.services.mozilla.com/v1/geolocate?key=%MOZILLA_API_KEY%");

// PREF: When geolocation is enabled, don't log geolocation requests to the console
lockPref("geo.wifi.logging.enabled", false);

// PREF: Disable raw TCP socket support (mozTCPSocket)
lockPref("dom.mozTCPSocket.enabled", false);

// PREF: Disable DOM storage (disabled)
//user_pref("dom.storage.enabled",		false);

// PREF: Disable leaking network/browser connection information via Javascript
lockPref("dom.netinfo.enabled", false);

// PREF: Disable network API (Firefox < 32)
lockPref("dom.network.enabled", false);

// PREF: Disable telephony API
lockPref("dom.telephony.enabled", false);

// PREF: Disable "beacon" asynchronous HTTP transfers (used for analytics)
lockPref("beacon.enabled", false);

// PREF: Disable clipboard event detection (onCut/onCopy/onPaste) via Javascript
lockPref("dom.event.clipboardevents.enabled", false);

// PREF: Disable "copy to clipboard" functionality via Javascript (Firefox >= 41)
lockPref("dom.allow_cut_copy", false);

// PREF: Disable speech recognition
lockPref("media.webspeech.recognition.enable", false);

// PREF: Disable speech synthesis
// https://developer.mozilla.org/en-US/docs/Web/API/SpeechSynthesis
lockPref("media.webspeech.synth.enabled", false);

// PREF: Disable sensor API
lockPref("device.sensors.enabled", false);

// PREF: Disable pinging URIs specified in HTML <a> ping= attributes
lockPref("browser.send_pings", false);
lockPref("browser.send_pings.require_same_host", true);

// PREF: Disable IndexedDB (disabled)
// NOTICE-DISABLED: IndexedDB could be used for tracking purposes, but is required for some add-ons to work (notably uBlock), so is left enabled
//user_pref("dom.indexedDB.enabled",		false);

// TODO: "Access Your Location" "Maintain Offline Storage" "Show Notifications"

// PREF: Disable gamepad API to prevent USB device enumeration
lockPref("dom.gamepad.enabled", false);

// PREF: Disable virtual reality devices APIs
lockPref("dom.vr.enabled", false);

// PREF: Disable vibrator API
lockPref("dom.vibrator.enabled", false);

// PREF: Disable resource timing API
// https://www.w3.org/TR/resource-timing/#privacy-security
lockPref("dom.enable_resource_timing", false);

// PREF: Disable Archive API (Firefox < 54)
lockPref("dom.archivereader.enabled", false);

// PREF: Spoof dual-core CPU
lockPref("dom.maxHardwareConcurrency", 8);